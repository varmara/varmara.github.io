<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R | Марина Варфоломеева</title>
    <link>https://varmara.github.io/ru/category/r/</link>
      <atom:link href="https://varmara.github.io/ru/category/r/index.xml" rel="self" type="application/rss+xml" />
    <description>R</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>ru</language><copyright>© Marina A. Varfolomeeva 2018-2021</copyright><lastBuildDate>Sat, 05 Jan 2019 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://varmara.github.io/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>R</title>
      <link>https://varmara.github.io/ru/category/r/</link>
    </image>
    
    <item>
      <title>Третий тип сумм квадратов и параметризация дисперсионного анализа</title>
      <link>https://varmara.github.io/ru/post/2019-01-05-ss-type-iii-and-anova-parametrization/</link>
      <pubDate>Sat, 05 Jan 2019 00:00:00 +0000</pubDate>
      <guid>https://varmara.github.io/ru/post/2019-01-05-ss-type-iii-and-anova-parametrization/</guid>
      <description>
&lt;script src=&#34;https://varmara.github.io/rmarkdown-libs/header-attrs/header-attrs.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;Выбор между разными параметризациями в дисперсионном анализе кажется сложной проблемой.&lt;/p&gt;
&lt;div id=&#34;типы-сумм-квадратов&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Типы сумм квадратов&lt;/h3&gt;
&lt;p&gt;Пусть у нас есть модель &lt;code&gt;Y ~ A + B + AB&lt;/code&gt; с двумя дискретными факторами и взаимодействием. Типы сумм квадратов — это всего лишь последовательность тестирования значимости факторов в этой модели. Самые часто-используемые типы сумм квадратов I, II и III. При использовании любого из них значимость взаимодействия будет проверяться всегда одинаково — по отношению к модели в которой нет взаимодействия, но есть оба фактора, т.е. SS(AB | A, B). Значимость факторов можно проверить в разном порядке.&lt;/p&gt;
&lt;p&gt;При использовании SS type I значимость факторов проверяется последовательно — в порядке включения в модель. Сначала будет рассчитана SS(A), потом SS(B|A) и, наконец, SS(AB | A, B).&lt;/p&gt;
&lt;p&gt;При использовании SS type II значимость факторов проверяется по сравнению с моделью, где есть другой фактор, но нет взаимодействия — это SS(A | B) и SS(B | A). При таком способе SS не будет зависеть от порядка включения факторов в модель, но будет зависеть от численности групп. Т.е. лучше, если группы будут одинаковыми.&lt;/p&gt;
&lt;p&gt;При использовании SS type III значимость фактора проверяется по сравнению с моделью в которой есть другой фактор и взаимодействие SS(A | B, AB) и SS(B|A, AB). Статистики на это ругаются, потому что при таком способе нарушается принцип маргинальности (взаимодействие может входить в модель только если в ней есть все его составляющие). При таком способе расчета SS уже не зависит от численности групп, поэтому его часто рекомендуют использовать для несбалансированных данных.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;типы-параметризации&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Типы параметризации&lt;/h3&gt;
&lt;p&gt;При классическом регрессионном подходе чаще используется параметризация индикаторных переменных: коэффициенты кодируют отклонения групповых средних от среднего на базовом уровне факторов (в R это используется по умолчанию, contr.treatment).&lt;/p&gt;
&lt;p&gt;В классическом дисперсионном анализе используется параметризация эффектов коэффициенты кодируют отклонения групповых средних от общего среднего (в R это называется contr.sum).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;как-параметризация-связана-с-типом-расчета-сумм-квадратов&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Как параметризация связана с типом расчета сумм квадратов?&lt;/h3&gt;
&lt;p&gt;В подавляющем большинстве случаев, оба варианта кодирования дадут одинаковый результат дисперсионного анализа. Но как только вы вдруг решите использовать SS type III, вспомнив, что он используется в большинстве статистических программ, вот тогда-то как раз бывает важно выбрать именно contr.sum.&lt;/p&gt;
&lt;p&gt;Так вот, при contr.treatment коэффициенты не соответствуют классическому определению главных эффектов факторов (main effect, эффект фактора, усредненный по всем другим факторам). Об этом подробно и хорошо написано &lt;a href=&#34;https://methodology.psu.edu/media/techreports/12-120.pdf&#34;&gt;здесь&lt;/a&gt;
При contr.treatment коэффициенты соответствуют простым эффектам (simple effect, эффект фактора на определенном уровне других факторов, не усредненный). &lt;a href=&#34;https://methodology.psu.edu/media/techreports/12-120.pdf&#34;&gt;На стр. 14&lt;/a&gt; показано, что коэффициент, кодирующий простой эффект, кодирует одновременно еще и часть взаимодействия. У этого есть два важных следствия:&lt;/p&gt;
&lt;p&gt;Во-первых, при наличии взаимодействия и contr.treatment автоматически возникает коллинеарность (Т.е. при проверке полной модели на коллинеарность, нужно использовать contr.sum, или трюк — проверять на коллинеарность неполную модель без взаимодействия).&lt;/p&gt;
&lt;p&gt;Во-вторых, и это сейчас для нас главное, из-за того, что при contr.treatment коэффициенты кодируют одновременно часть взаимодействия, то при использовании SS type III получатся неправильные SS. Например, когда мы считаем SS(A| B, AB), эффект фактора A мы оцениваем, сравнивая модели A + B + AB и B + AB. Но выбрасывая фактор A мы удаляем не только главный эффект, но и часть взаимодействия (на самом деле, все даже еще немного сложнее).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;как-выбрать-подходящий-тип-расчета-сумм-квадратов-и-подходящую-параметризацию&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Как выбрать подходящий тип расчета сумм квадратов и подходящую параметризацию?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Если у вас есть модель без взаимодействия, вам не нужен SS type III, в нем нет смысла.&lt;/li&gt;
&lt;li&gt;Если у вас есть модель со взаимодействием и сбалансированные данные или дисбаланс не очень велик, вы можете смело использовать SS type II. И тогда не важно, какую параметризацию использовать, главное помнить про трактовку коэффициентов, а для проверки на коллинеарность — использовать модель без взаимодействия.&lt;/li&gt;
&lt;li&gt;И наконец, если у вас есть модель со взаимодействием, но данные не сбалансированы, можно использовать SS type III, но обязательно в параметризации contr.sum&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
